var Ractive=require("ractive"),ajax=require("../lib/Ajax"),fetcher=function(){var t=this;return ajax.request({url:t.get("url"),json:!0}).done(function(e){t.set("value",e)}).fail(function(e){console.log(e.key),t.fire("Error fetching ",t.get("url"))}),this},creator=function(t){return ajax.request({url:this.get("url"),method:"POST",data:this.get("value"),json:!0}).done(function(e){t&&t(null,e)}).fail(function(e){t&&t(JSON.parse(e.responseText))}),this},updater=function(t){return ajax.request({url:this.get("url"),method:this.get("value"),data:this.get("value"),json:!0}).done(function(e){t&&t(null,e)}).fail(function(e){t&&t(JSON.parse(e.responseText))}),this},deleter=function(t){return ajax.request({url:this.get("url"),method:this.get("value"),json:!0}).done(function(e){t&&t(null,e)}).fail(function(e){t&&t(JSON.parse(e.responseText))}),this},bindingComponent=function(n){return n&&this.observe("value",function(e){for(var t in e)n.set(t,e[t])},{init:!1}),this},Setter=function(t){var n=this;return function(e){n.set(t,e)}};module.exports=Ractive.extend({data:{value:null,url:""},fetch:function(){return fetcher.call(this)},bindComponent:function(e){return bindingComponent(e)},create:function(e){return creator(e)},save:function(e){return updater(e)},del:function(e){return deleter(e)},setter:function(e){return Setter(e)}});